{
  "sha": "fbf648ebba32bbc5aa571a4b09e2062a65fd2492",
  "node_id": "MDY6Q29tbWl0ODE1OTg5NjE6ZmJmNjQ4ZWJiYTMyYmJjNWFhNTcxYTRiMDllMjA2MmE2NWZkMjQ5Mg==",
  "commit": {
    "author": {
      "name": "Benjamin Peterson",
      "email": "benjamin@python.org",
      "date": "2014-01-14T03:59:38Z"
    },
    "committer": {
      "name": "Benjamin Peterson",
      "email": "benjamin@python.org",
      "date": "2014-01-14T03:59:38Z"
    },
    "message": "complain when nbytes > buflen to fix possible buffer overflow (closes #20246)",
    "tree": {
      "sha": "7d43948ea60cfe21b4db5007f8afd6700b230264",
      "url": "https://api.github.com/repos/python/cpython/git/trees/7d43948ea60cfe21b4db5007f8afd6700b230264"
    },
    "url": "https://api.github.com/repos/python/cpython/git/commits/fbf648ebba32bbc5aa571a4b09e2062a65fd2492",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/python/cpython/commits/fbf648ebba32bbc5aa571a4b09e2062a65fd2492",
  "html_url": "https://github.com/python/cpython/commit/fbf648ebba32bbc5aa571a4b09e2062a65fd2492",
  "comments_url": "https://api.github.com/repos/python/cpython/commits/fbf648ebba32bbc5aa571a4b09e2062a65fd2492/comments",
  "author": {
    "login": "benjaminp",
    "id": 219470,
    "node_id": "MDQ6VXNlcjIxOTQ3MA==",
    "avatar_url": "https://avatars1.githubusercontent.com/u/219470?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/benjaminp",
    "html_url": "https://github.com/benjaminp",
    "followers_url": "https://api.github.com/users/benjaminp/followers",
    "following_url": "https://api.github.com/users/benjaminp/following{/other_user}",
    "gists_url": "https://api.github.com/users/benjaminp/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/benjaminp/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benjaminp/subscriptions",
    "organizations_url": "https://api.github.com/users/benjaminp/orgs",
    "repos_url": "https://api.github.com/users/benjaminp/repos",
    "events_url": "https://api.github.com/users/benjaminp/events{/privacy}",
    "received_events_url": "https://api.github.com/users/benjaminp/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "benjaminp",
    "id": 219470,
    "node_id": "MDQ6VXNlcjIxOTQ3MA==",
    "avatar_url": "https://avatars1.githubusercontent.com/u/219470?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/benjaminp",
    "html_url": "https://github.com/benjaminp",
    "followers_url": "https://api.github.com/users/benjaminp/followers",
    "following_url": "https://api.github.com/users/benjaminp/following{/other_user}",
    "gists_url": "https://api.github.com/users/benjaminp/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/benjaminp/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benjaminp/subscriptions",
    "organizations_url": "https://api.github.com/users/benjaminp/orgs",
    "repos_url": "https://api.github.com/users/benjaminp/repos",
    "events_url": "https://api.github.com/users/benjaminp/events{/privacy}",
    "received_events_url": "https://api.github.com/users/benjaminp/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "f60b7df9f8dd1df21921aa124a30bfd4fe9714b2",
      "url": "https://api.github.com/repos/python/cpython/commits/f60b7df9f8dd1df21921aa124a30bfd4fe9714b2",
      "html_url": "https://github.com/python/cpython/commit/f60b7df9f8dd1df21921aa124a30bfd4fe9714b2"
    }
  ],
  "stats": {
    "total": 16,
    "additions": 16,
    "deletions": 0
  },
  "files": [
    {
      "sha": "290c4dd0968ee2676cf71543537ccc77eea6c549",
      "filename": "Lib/test/test_socket.py",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/python/cpython/blob/fbf648ebba32bbc5aa571a4b09e2062a65fd2492/Lib/test/test_socket.py",
      "raw_url": "https://github.com/python/cpython/raw/fbf648ebba32bbc5aa571a4b09e2062a65fd2492/Lib/test/test_socket.py",
      "contents_url": "https://api.github.com/repos/python/cpython/contents/Lib/test/test_socket.py?ref=fbf648ebba32bbc5aa571a4b09e2062a65fd2492",
      "patch": "@@ -1968,6 +1968,14 @@ def testRecvFromIntoMemoryview(self):\n \n     _testRecvFromIntoMemoryview = _testRecvFromIntoArray\n \n+    def testRecvFromIntoSmallBuffer(self):\n+        # See issue #20246.\n+        buf = bytearray(8)\n+        self.assertRaises(ValueError, self.cli_conn.recvfrom_into, buf, 1024)\n+\n+    def _testRecvFromIntoSmallBuffer(self):\n+        self.serv_conn.send(MSG*2048)\n+\n \n TIPC_STYPE = 2000\n TIPC_LOWER = 200"
    },
    {
      "sha": "5236e1066b28e2d8c28c0341a1206c663a2fe1ed",
      "filename": "Misc/ACKS",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/python/cpython/blob/fbf648ebba32bbc5aa571a4b09e2062a65fd2492/Misc/ACKS",
      "raw_url": "https://github.com/python/cpython/raw/fbf648ebba32bbc5aa571a4b09e2062a65fd2492/Misc/ACKS",
      "contents_url": "https://api.github.com/repos/python/cpython/contents/Misc/ACKS?ref=fbf648ebba32bbc5aa571a4b09e2062a65fd2492",
      "patch": "@@ -1020,6 +1020,7 @@ Eric V. Smith\n Christopher Smith\n Gregory P. Smith\n Roy Smith\n+Ryan Smith-Roberts\n Rafal Smotrzyk\n Dirk Soede\n Paul Sokolovsky"
    },
    {
      "sha": "693a0c8076326826ac59d08901080ae4730f9468",
      "filename": "Misc/NEWS",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/python/cpython/blob/fbf648ebba32bbc5aa571a4b09e2062a65fd2492/Misc/NEWS",
      "raw_url": "https://github.com/python/cpython/raw/fbf648ebba32bbc5aa571a4b09e2062a65fd2492/Misc/NEWS",
      "contents_url": "https://api.github.com/repos/python/cpython/contents/Misc/NEWS?ref=fbf648ebba32bbc5aa571a4b09e2062a65fd2492",
      "patch": "@@ -10,6 +10,8 @@ What's New in Python 3.2.6?\n Library\n -------\n \n+- Issue #20246: Fix buffer overflow in socket.recvfrom_into.\n+\n - Issue #12226: HTTPS is now used by default when connecting to PyPI.\n \n - Issue #19435: Fix directory traversal attack on CGIHttpRequestHandler."
    },
    {
      "sha": "903e10c98cc81c251879ed6561b473ce4ffab123",
      "filename": "Modules/socketmodule.c",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/python/cpython/blob/fbf648ebba32bbc5aa571a4b09e2062a65fd2492/Modules/socketmodule.c",
      "raw_url": "https://github.com/python/cpython/raw/fbf648ebba32bbc5aa571a4b09e2062a65fd2492/Modules/socketmodule.c",
      "contents_url": "https://api.github.com/repos/python/cpython/contents/Modules/socketmodule.c?ref=fbf648ebba32bbc5aa571a4b09e2062a65fd2492",
      "patch": "@@ -2598,6 +2598,11 @@ sock_recvfrom_into(PySocketSockObject *s, PyObject *args, PyObject* kwds)\n     if (recvlen == 0) {\n         /* If nbytes was not specified, use the buffer's length */\n         recvlen = buflen;\n+    } else if (recvlen > buflen) {\n+        PyBuffer_Release(&pbuf);\n+        PyErr_SetString(PyExc_ValueError,\n+                        \"nbytes is greater than the length of the buffer\");\n+        return NULL;\n     }\n \n     readlen = sock_recvfrom_guts(s, buf, recvlen, flags, &addr);"
    }
  ]
}